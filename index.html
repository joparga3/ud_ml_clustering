<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Jose Parreno Garcia" />


<title>Clustering</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Clustering</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Clustering</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Clustering</h1>
<h4 class="author"><em>Jose Parreno Garcia</em></h4>
<h4 class="date"><em>February 2018</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#hierarchical-clustering"><span class="toc-section-number">1</span> Hierarchical clustering</a><ul>
<li><a href="#preparing-the-data"><span class="toc-section-number">1.1</span> Preparing the data</a></li>
<li><a href="#simple-hierarchical-cluster"><span class="toc-section-number">1.2</span> Simple hierarchical cluster</a></li>
<li><a href="#divisive-hierarchical-cluster"><span class="toc-section-number">1.3</span> Divisive hierarchical cluster</a></li>
<li><a href="#drawing-a-horizontal-dendogram"><span class="toc-section-number">1.4</span> Drawing a horizontal dendogram</a></li>
</ul></li>
<li><a href="#cutting-trees-into-clusters"><span class="toc-section-number">2</span> Cutting trees into clusters</a></li>
<li><a href="#clustering-with-k-means"><span class="toc-section-number">3</span> Clustering with k-means</a></li>
<li><a href="#bivariate-cluster-plot"><span class="toc-section-number">4</span> Bivariate cluster plot</a></li>
<li><a href="#comparing-clustering-methods"><span class="toc-section-number">5</span> Comparing clustering methods</a><ul>
<li><a href="#extracting-silhouette-information-from-clustering"><span class="toc-section-number">5.1</span> Extracting Silhouette information from Clustering</a></li>
</ul></li>
<li><a href="#optimum-number-of-clusters-for-k-means"><span class="toc-section-number">6</span> optimum number of clusters for k-means</a></li>
<li><a href="#clustering-data-with-density-based-method"><span class="toc-section-number">7</span> Clustering data with density-based method</a></li>
<li><a href="#clustering-data-with-model-based-method"><span class="toc-section-number">8</span> Clustering data with model-based method</a></li>
<li><a href="#dissimilarity-matrix"><span class="toc-section-number">9</span> Dissimilarity matrix</a></li>
</ul>
</div>

<style>
body {
text-align: justify}

</style>
<p><br></p>
<pre class="r"><code>library(knitr)</code></pre>
<p><br></p>
<p>We will look at:</p>
<ul>
<li>Hierarchical clustering</li>
<li>Cutting trees into clusters</li>
<li>Clustering with k-means</li>
<li>Bivariate cluster plot</li>
<li>Random forest</li>
<li>optimum number of clusters for k-means</li>
<li>Clustering data with density-based method</li>
<li>Clustering data with model-based method</li>
<li>Dissimilarity matrix</li>
</ul>
<p><br></p>
<div id="hierarchical-clustering" class="section level1">
<h1><span class="header-section-number">1</span> Hierarchical clustering</h1>
<p><img src="images/1.PNG" width="715" /><img src="images/2.PNG" width="715" /><img src="images/3.PNG" width="633" /></p>
<div id="preparing-the-data" class="section level2">
<h2><span class="header-section-number">1.1</span> Preparing the data</h2>
<pre class="r"><code>customer = read.csv(&#39;customer.txt&#39;, header = TRUE)
head(customer)</code></pre>
<pre><code>##   ID Visit.Time Average.Expense Sex Age
## 1  1          3             5.7   0  10
## 2  2          5            14.5   0  27
## 3  3         16            33.5   0  32
## 4  4          5            15.9   0  30
## 5  5         16            24.9   0  23
## 6  6          3            12.0   0  15</code></pre>
<pre class="r"><code>str(customer)</code></pre>
<pre><code>## &#39;data.frame&#39;:    60 obs. of  5 variables:
##  $ ID             : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Visit.Time     : int  3 5 16 5 16 3 12 14 6 3 ...
##  $ Average.Expense: num  5.7 14.5 33.5 15.9 24.9 12 28.5 18.8 23.8 5.3 ...
##  $ Sex            : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Age            : int  10 27 32 30 23 15 33 27 16 11 ...</code></pre>
<pre class="r"><code># Normalise data to the same scale
customer = scale(customer[,-1])</code></pre>
</div>
<div id="simple-hierarchical-cluster" class="section level2">
<h2><span class="header-section-number">1.2</span> Simple hierarchical cluster</h2>
<pre class="r"><code>hc = hclust(dist(customer, method=&quot;euclidean&quot;), method=&quot;ward.D2&quot;)
hc</code></pre>
<pre><code>## 
## Call:
## hclust(d = dist(customer, method = &quot;euclidean&quot;), method = &quot;ward.D2&quot;)
## 
## Cluster method   : ward.D2 
## Distance         : euclidean 
## Number of objects: 60</code></pre>
<pre class="r"><code>plot(hc, hang = -0.01, cex = 0.7)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" /><!-- --></p>
<pre class="r"><code>hc2 = hclust(dist(customer), method=&quot;single&quot;)
plot(hc2, hang = -0.01, cex = 0.7)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-4-2.png" /><!-- --></p>
</div>
<div id="divisive-hierarchical-cluster" class="section level2">
<h2><span class="header-section-number">1.3</span> Divisive hierarchical cluster</h2>
<pre class="r"><code>library(cluster)

dv = diana(customer, metric = &quot;euclidean&quot;)

plot(dv)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" /><!-- --><img src="index_files/figure-html/unnamed-chunk-5-2.png" /><!-- --></p>
</div>
<div id="drawing-a-horizontal-dendogram" class="section level2">
<h2><span class="header-section-number">1.4</span> Drawing a horizontal dendogram</h2>
<pre class="r"><code>library(dendextend)
library(magrittr)

dend = customer %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram

dend %&gt;% plot(horiz=TRUE, main = &quot;Horizontal Dendrogram&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" /><!-- --></p>
<p><br></p>
</div>
</div>
<div id="cutting-trees-into-clusters" class="section level1">
<h1><span class="header-section-number">2</span> Cutting trees into clusters</h1>
<pre class="r"><code># Separate the data into a given number of clusters. IE, cut the hierarchical tree
fit = cutree(hc, k = 4)

fit</code></pre>
<pre><code>##  [1] 1 1 2 1 2 1 2 2 1 1 1 2 2 1 1 1 2 1 2 3 4 3 4 3 3 4 4 3 4 4 4 3 3 3 4 4 3 4 4 4 4 4 4 4 3 3 4 4 4 3 4 3 3 4 4 4 3 4 4 3</code></pre>
<pre class="r"><code>table(fit)</code></pre>
<pre><code>## fit
##  1  2  3  4 
## 11  8 16 25</code></pre>
<pre class="r"><code>plot(hc)
rect.hclust(hc, k = 4 , border=&quot;red&quot;)
rect.hclust(hc, k = 4 , which =2, border=&quot;green&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" /><!-- --></p>
<pre class="r"><code>d = dend %&gt;% color_branches(k=4) %&gt;% plot(horiz=TRUE, main =&quot;Horizontal Dendrogram&quot;)

abline(v = heights_per_k.dendrogram(dend)[&quot;4&quot;] + .1, lwd = 2,lty = 2, col = &quot;blue&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-7-2.png" /><!-- --></p>
<p><br></p>
</div>
<div id="clustering-with-k-means" class="section level1">
<h1><span class="header-section-number">3</span> Clustering with k-means</h1>
<p><img src="images/4.PNG" width="700" /></p>
<pre class="r"><code>library(stats)

set.seed(22)
# KMEANS DOES NEED THE DEFINITION OF K
fit = kmeans(customer, 4)
fit</code></pre>
<pre><code>## K-means clustering with 4 clusters of sizes 8, 11, 16, 25
## 
## Cluster means:
##   Visit.Time Average.Expense        Sex        Age
## 1  1.3302016       1.0155226 -1.4566845  0.5591307
## 2 -0.7771737      -0.5178412 -1.4566845 -0.4774599
## 3  0.8571173       0.9887331  0.6750489  1.0505015
## 4 -0.6322632      -0.7299063  0.6750489 -0.6411604
## 
## Clustering vector:
##  [1] 2 2 1 2 1 2 1 1 2 2 2 1 1 2 2 2 1 2 1 3 4 3 4 3 3 4 4 3 4 4 4 3 3 3 4 4 3 4 4 4 4 4 4 4 3 3 4 4 4 3 4 3 3 4 4 4 3 4 4 3
## 
## Within cluster sum of squares by cluster:
## [1]  5.90040 11.97454 22.58236 20.89159
##  (between_SS / total_SS =  74.0 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<pre class="r"><code>barplot(t(fit$centers), beside = TRUE,xlab=&quot;cluster&quot;,ylab=&quot;value&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" /><!-- --></p>
<pre class="r"><code>plot(customer, col = fit$cluster)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-9-2.png" /><!-- --></p>
<p><br></p>
</div>
<div id="bivariate-cluster-plot" class="section level1">
<h1><span class="header-section-number">4</span> Bivariate cluster plot</h1>
<p><img src="images/5.PNG" width="703" /></p>
<pre class="r"><code>library(cluster)

clusplot(customer, fit$cluster, color=TRUE, shade=TRUE)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" /><!-- --></p>
<pre class="r"><code># zoom in
par(mfrow= c(1,2))
clusplot(customer, fit$cluster, color=TRUE, shade=TRUE)
rect(-0.7,-1.7, 2.2,-1.2, border = &quot;orange&quot;, lwd=2)
clusplot(customer, fit$cluster, color = TRUE, xlim = 
           c(-0.7,2.2), ylim = c(-1.7,-1.2))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-2.png" /><!-- --></p>
<pre class="r"><code>par(mfrow= c(1,1))
mds = cmdscale(dist(customer), k = 2)
plot(mds, col = fit$cluster)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-3.png" /><!-- --></p>
<p><br></p>
</div>
<div id="comparing-clustering-methods" class="section level1">
<h1><span class="header-section-number">5</span> Comparing clustering methods</h1>
<pre class="r"><code>library(fpc)

single_c = hclust(dist(customer), method=&quot;single&quot;)
hc_single = cutree(single_c, k = 4)

complete_c = hclust(dist(customer), method=&quot;complete&quot;)
hc_complete = cutree(complete_c, k = 4)

set.seed(22)
km = kmeans(customer, 4)

# GENERATE CLUSTER STATS
cs = cluster.stats(dist(customer), km$cluster)

cs[c(&quot;within.cluster.ss&quot;,&quot;avg.silwidth&quot;)]</code></pre>
<pre><code>## $within.cluster.ss
## [1] 61.3489
## 
## $avg.silwidth
## [1] 0.4640587</code></pre>
<pre class="r"><code>sapply(list(kmeans = km$cluster, hc_single = hc_single, hc_complete = hc_complete),
       function(c) cluster.stats(dist(customer),c)[c(&quot;within.cluster.ss&quot;,&quot;avg.silwidth&quot;)])</code></pre>
<pre><code>##                   kmeans    hc_single hc_complete
## within.cluster.ss 61.3489   136.0092  65.94076   
## avg.silwidth      0.4640587 0.2481926 0.4255961</code></pre>
<p><img src="images/6.PNG" width="729" /></p>
<div id="extracting-silhouette-information-from-clustering" class="section level2">
<h2><span class="header-section-number">5.1</span> Extracting Silhouette information from Clustering</h2>
<p><img src="images/7.PNG" width="735" /></p>
<pre class="r"><code>set.seed(22)
km = kmeans(customer, 4)

kms = silhouette(km$cluster,dist(customer))
summary(kms)</code></pre>
<pre><code>## Silhouette of 60 units in 4 clusters from silhouette.default(x = km$cluster, dist = dist(customer)) :
##  Cluster sizes and average silhouette widths:
##         8        11        16        25 
## 0.5464597 0.4080823 0.3794910 0.5164434 
## Individual silhouette widths:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.1931  0.4030  0.4890  0.4641  0.5422  0.6333</code></pre>
<pre class="r"><code>plot(kms)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p>
<p><br></p>
</div>
</div>
<div id="optimum-number-of-clusters-for-k-means" class="section level1">
<h1><span class="header-section-number">6</span> optimum number of clusters for k-means</h1>
<pre class="r"><code>nk = 2:10
set.seed(22)
WSS = sapply(nk, function(k) {
  kmeans(customer, centers=k)$tot.withinss
 })
WSS</code></pre>
<pre><code>## [1] 123.49224  88.07028  61.34890  48.76431  47.20813  45.48114  29.58014  28.87519  23.21331</code></pre>
<pre class="r"><code>plot(nk, WSS, type=&quot;l&quot;, xlab= &quot;number of k&quot;, ylab=&quot;within sum of squares&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" /><!-- --></p>
<pre class="r"><code>SW = sapply(nk, function(k) {
  cluster.stats(dist(customer), kmeans(customer,
                                         centers=k)$cluster)$avg.silwidth
  })
SW</code></pre>
<pre><code>## [1] 0.4203896 0.4092890 0.4640587 0.4308448 0.4160309 0.4241364 0.3637102 0.3540200 0.3436709</code></pre>
<pre class="r"><code>plot(nk, SW, type=&quot;l&quot;, xlab=&quot;number of clusers&quot;, ylab=&quot;average silhouette width&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-16-2.png" /><!-- --></p>
<pre class="r"><code>nk[which.max(SW)]</code></pre>
<pre><code>## [1] 4</code></pre>
<p><br></p>
</div>
<div id="clustering-data-with-density-based-method" class="section level1">
<h1><span class="header-section-number">7</span> Clustering data with density-based method</h1>
<p><img src="images/8.PNG" width="717" /><img src="images/9.PNG" width="725" /><img src="images/10.PNG" width="568" /><img src="images/11.PNG" width="727" /></p>
<pre class="r"><code>library(mlbench)
library(fpc)

set.seed(2)
p = mlbench.cassini(500)
plot(p$x)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" /><!-- --></p>
<pre class="r"><code>ds = dbscan(dist(p$x),0.2, 2, countmode=NULL, method=&quot;dist&quot;)
ds</code></pre>
<pre><code>## dbscan Pts=500 MinPts=2 eps=0.2
##         1   2   3
## seed  200 200 100
## total 200 200 100</code></pre>
<pre class="r"><code>plot(ds, p$x)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-18-2.png" /><!-- --></p>
<pre class="r"><code>y = matrix(0,nrow=3,ncol=2)
y[1,] = c(0,0)
y[2,] = c(0,-1.5)
y[3,] = c(1,1)
y</code></pre>
<pre><code>##      [,1] [,2]
## [1,]    0  0.0
## [2,]    0 -1.5
## [3,]    1  1.0</code></pre>
<pre class="r"><code>predict(ds, p$x, y)</code></pre>
<pre><code>## [1] 3 1 2</code></pre>
<p><br></p>
</div>
<div id="clustering-data-with-model-based-method" class="section level1">
<h1><span class="header-section-number">8</span> Clustering data with model-based method</h1>
<p><img src="images/12.PNG" width="729" /></p>
<pre class="r"><code>library(mclust)

mb = Mclust(customer)</code></pre>
<pre><code>## fitting ...
## 
  |                                                                                                                                                                                                                                                      
  |                                                                                                                                                                                                                                                |   0%
  |                                                                                                                                                                                                                                                      
  |==                                                                                                                                                                                                                                              |   1%
  |                                                                                                                                                                                                                                                      
  |====                                                                                                                                                                                                                                            |   2%
  |                                                                                                                                                                                                                                                      
  |======                                                                                                                                                                                                                                          |   2%
  |                                                                                                                                                                                                                                                      
  |========                                                                                                                                                                                                                                        |   3%
  |                                                                                                                                                                                                                                                      
  |=========                                                                                                                                                                                                                                       |   4%
  |                                                                                                                                                                                                                                                      
  |===========                                                                                                                                                                                                                                     |   5%
  |                                                                                                                                                                                                                                                      
  |=============                                                                                                                                                                                                                                   |   6%
  |                                                                                                                                                                                                                                                      
  |===============                                                                                                                                                                                                                                 |   6%
  |                                                                                                                                                                                                                                                      
  |=================                                                                                                                                                                                                                               |   7%
  |                                                                                                                                                                                                                                                      
  |===================                                                                                                                                                                                                                             |   8%
  |                                                                                                                                                                                                                                                      
  |=====================                                                                                                                                                                                                                           |   9%
  |                                                                                                                                                                                                                                                      
  |=======================                                                                                                                                                                                                                         |   9%
  |                                                                                                                                                                                                                                                      
  |=========================                                                                                                                                                                                                                       |  10%
  |                                                                                                                                                                                                                                                      
  |==========================                                                                                                                                                                                                                      |  11%
  |                                                                                                                                                                                                                                                      
  |============================                                                                                                                                                                                                                    |  12%
  |                                                                                                                                                                                                                                                      
  |==============================                                                                                                                                                                                                                  |  13%
  |                                                                                                                                                                                                                                                      
  |================================                                                                                                                                                                                                                |  13%
  |                                                                                                                                                                                                                                                      
  |==================================                                                                                                                                                                                                              |  14%
  |                                                                                                                                                                                                                                                      
  |====================================                                                                                                                                                                                                            |  15%
  |                                                                                                                                                                                                                                                      
  |======================================                                                                                                                                                                                                          |  16%
  |                                                                                                                                                                                                                                                      
  |========================================                                                                                                                                                                                                        |  17%
  |                                                                                                                                                                                                                                                      
  |==========================================                                                                                                                                                                                                      |  17%
  |                                                                                                                                                                                                                                                      
  |===========================================                                                                                                                                                                                                     |  18%
  |                                                                                                                                                                                                                                                      
  |=============================================                                                                                                                                                                                                   |  19%
  |                                                                                                                                                                                                                                                      
  |===============================================                                                                                                                                                                                                 |  20%
  |                                                                                                                                                                                                                                                      
  |=================================================                                                                                                                                                                                               |  20%
  |                                                                                                                                                                                                                                                      
  |===================================================                                                                                                                                                                                             |  21%
  |                                                                                                                                                                                                                                                      
  |=====================================================                                                                                                                                                                                           |  22%
  |                                                                                                                                                                                                                                                      
  |=======================================================                                                                                                                                                                                         |  23%
  |                                                                                                                                                                                                                                                      
  |=========================================================                                                                                                                                                                                       |  24%
  |                                                                                                                                                                                                                                                      
  |===========================================================                                                                                                                                                                                     |  24%
  |                                                                                                                                                                                                                                                      
  |============================================================                                                                                                                                                                                    |  25%
  |                                                                                                                                                                                                                                                      
  |==============================================================                                                                                                                                                                                  |  26%
  |                                                                                                                                                                                                                                                      
  |================================================================                                                                                                                                                                                |  27%
  |                                                                                                                                                                                                                                                      
  |==================================================================                                                                                                                                                                              |  28%
  |                                                                                                                                                                                                                                                      
  |====================================================================                                                                                                                                                                            |  28%
  |                                                                                                                                                                                                                                                      
  |======================================================================                                                                                                                                                                          |  29%
  |                                                                                                                                                                                                                                                      
  |========================================================================                                                                                                                                                                        |  30%
  |                                                                                                                                                                                                                                                      
  |==========================================================================                                                                                                                                                                      |  31%
  |                                                                                                                                                                                                                                                      
  |============================================================================                                                                                                                                                                    |  31%
  |                                                                                                                                                                                                                                                      
  |=============================================================================                                                                                                                                                                   |  32%
  |                                                                                                                                                                                                                                                      
  |===============================================================================                                                                                                                                                                 |  33%
  |                                                                                                                                                                                                                                                      
  |=================================================================================                                                                                                                                                               |  34%
  |                                                                                                                                                                                                                                                      
  |===================================================================================                                                                                                                                                             |  35%
  |                                                                                                                                                                                                                                                      
  |=====================================================================================                                                                                                                                                           |  35%
  |                                                                                                                                                                                                                                                      
  |=======================================================================================                                                                                                                                                         |  36%
  |                                                                                                                                                                                                                                                      
  |=========================================================================================                                                                                                                                                       |  37%
  |                                                                                                                                                                                                                                                      
  |===========================================================================================                                                                                                                                                     |  38%
  |                                                                                                                                                                                                                                                      
  |=============================================================================================                                                                                                                                                   |  39%
  |                                                                                                                                                                                                                                                      
  |==============================================================================================                                                                                                                                                  |  39%
  |                                                                                                                                                                                                                                                      
  |================================================================================================                                                                                                                                                |  40%
  |                                                                                                                                                                                                                                                      
  |==================================================================================================                                                                                                                                              |  41%
  |                                                                                                                                                                                                                                                      
  |====================================================================================================                                                                                                                                            |  42%
  |                                                                                                                                                                                                                                                      
  |======================================================================================================                                                                                                                                          |  43%
  |                                                                                                                                                                                                                                                      
  |========================================================================================================                                                                                                                                        |  43%
  |                                                                                                                                                                                                                                                      
  |==========================================================================================================                                                                                                                                      |  44%
  |                                                                                                                                                                                                                                                      
  |============================================================================================================                                                                                                                                    |  45%
  |                                                                                                                                                                                                                                                      
  |==============================================================================================================                                                                                                                                  |  46%
  |                                                                                                                                                                                                                                                      
  |===============================================================================================================                                                                                                                                 |  46%
  |                                                                                                                                                                                                                                                      
  |=================================================================================================================                                                                                                                               |  47%
  |                                                                                                                                                                                                                                                      
  |===================================================================================================================                                                                                                                             |  48%
  |                                                                                                                                                                                                                                                      
  |=====================================================================================================================                                                                                                                           |  49%
  |                                                                                                                                                                                                                                                      
  |=======================================================================================================================                                                                                                                         |  50%
  |                                                                                                                                                                                                                                                      
  |=========================================================================================================================                                                                                                                       |  50%
  |                                                                                                                                                                                                                                                      
  |===========================================================================================================================                                                                                                                     |  51%
  |                                                                                                                                                                                                                                                      
  |=============================================================================================================================                                                                                                                   |  52%
  |                                                                                                                                                                                                                                                      
  |===============================================================================================================================                                                                                                                 |  53%
  |                                                                                                                                                                                                                                                      
  |=================================================================================================================================                                                                                                               |  54%
  |                                                                                                                                                                                                                                                      
  |==================================================================================================================================                                                                                                              |  54%
  |                                                                                                                                                                                                                                                      
  |====================================================================================================================================                                                                                                            |  55%
  |                                                                                                                                                                                                                                                      
  |======================================================================================================================================                                                                                                          |  56%
  |                                                                                                                                                                                                                                                      
  |========================================================================================================================================                                                                                                        |  57%
  |                                                                                                                                                                                                                                                      
  |==========================================================================================================================================                                                                                                      |  57%
  |                                                                                                                                                                                                                                                      
  |============================================================================================================================================                                                                                                    |  58%
  |                                                                                                                                                                                                                                                      
  |==============================================================================================================================================                                                                                                  |  59%
  |                                                                                                                                                                                                                                                      
  |================================================================================================================================================                                                                                                |  60%
  |                                                                                                                                                                                                                                                      
  |==================================================================================================================================================                                                                                              |  61%
  |                                                                                                                                                                                                                                                      
  |===================================================================================================================================================                                                                                             |  61%
  |                                                                                                                                                                                                                                                      
  |=====================================================================================================================================================                                                                                           |  62%
  |                                                                                                                                                                                                                                                      
  |=======================================================================================================================================================                                                                                         |  63%
  |                                                                                                                                                                                                                                                      
  |=========================================================================================================================================================                                                                                       |  64%
  |                                                                                                                                                                                                                                                      
  |===========================================================================================================================================================                                                                                     |  65%
  |                                                                                                                                                                                                                                                      
  |=============================================================================================================================================================                                                                                   |  65%
  |                                                                                                                                                                                                                                                      
  |===============================================================================================================================================================                                                                                 |  66%
  |                                                                                                                                                                                                                                                      
  |=================================================================================================================================================================                                                                               |  67%
  |                                                                                                                                                                                                                                                      
  |===================================================================================================================================================================                                                                             |  68%
  |                                                                                                                                                                                                                                                      
  |====================================================================================================================================================================                                                                            |  69%
  |                                                                                                                                                                                                                                                      
  |======================================================================================================================================================================                                                                          |  69%
  |                                                                                                                                                                                                                                                      
  |========================================================================================================================================================================                                                                        |  70%
  |                                                                                                                                                                                                                                                      
  |==========================================================================================================================================================================                                                                      |  71%
  |                                                                                                                                                                                                                                                      
  |============================================================================================================================================================================                                                                    |  72%
  |                                                                                                                                                                                                                                                      
  |==============================================================================================================================================================================                                                                  |  72%
  |                                                                                                                                                                                                                                                      
  |================================================================================================================================================================================                                                                |  73%
  |                                                                                                                                                                                                                                                      
  |==================================================================================================================================================================================                                                              |  74%
  |                                                                                                                                                                                                                                                      
  |====================================================================================================================================================================================                                                            |  75%
  |                                                                                                                                                                                                                                                      
  |=====================================================================================================================================================================================                                                           |  76%
  |                                                                                                                                                                                                                                                      
  |=======================================================================================================================================================================================                                                         |  76%
  |                                                                                                                                                                                                                                                      
  |=========================================================================================================================================================================================                                                       |  77%
  |                                                                                                                                                                                                                                                      
  |===========================================================================================================================================================================================                                                     |  78%
  |                                                                                                                                                                                                                                                      
  |=============================================================================================================================================================================================                                                   |  79%
  |                                                                                                                                                                                                                                                      
  |===============================================================================================================================================================================================                                                 |  80%
  |                                                                                                                                                                                                                                                      
  |=================================================================================================================================================================================================                                               |  80%
  |                                                                                                                                                                                                                                                      
  |===================================================================================================================================================================================================                                             |  81%
  |                                                                                                                                                                                                                                                      
  |=====================================================================================================================================================================================================                                           |  82%
  |                                                                                                                                                                                                                                                      
  |======================================================================================================================================================================================================                                          |  83%
  |                                                                                                                                                                                                                                                      
  |========================================================================================================================================================================================================                                        |  83%
  |                                                                                                                                                                                                                                                      
  |==========================================================================================================================================================================================================                                      |  84%
  |                                                                                                                                                                                                                                                      
  |============================================================================================================================================================================================================                                    |  85%
  |                                                                                                                                                                                                                                                      
  |==============================================================================================================================================================================================================                                  |  86%
  |                                                                                                                                                                                                                                                      
  |================================================================================================================================================================================================================                                |  87%
  |                                                                                                                                                                                                                                                      
  |==================================================================================================================================================================================================================                              |  87%
  |                                                                                                                                                                                                                                                      
  |====================================================================================================================================================================================================================                            |  88%
  |                                                                                                                                                                                                                                                      
  |======================================================================================================================================================================================================================                          |  89%
  |                                                                                                                                                                                                                                                      
  |=======================================================================================================================================================================================================================                         |  90%
  |                                                                                                                                                                                                                                                      
  |=========================================================================================================================================================================================================================                       |  91%
  |                                                                                                                                                                                                                                                      
  |===========================================================================================================================================================================================================================                     |  91%
  |                                                                                                                                                                                                                                                      
  |=============================================================================================================================================================================================================================                   |  92%
  |                                                                                                                                                                                                                                                      
  |===============================================================================================================================================================================================================================                 |  93%
  |                                                                                                                                                                                                                                                      
  |=================================================================================================================================================================================================================================               |  94%
  |                                                                                                                                                                                                                                                      
  |===================================================================================================================================================================================================================================             |  94%
  |                                                                                                                                                                                                                                                      
  |=====================================================================================================================================================================================================================================           |  95%
  |                                                                                                                                                                                                                                                      
  |=======================================================================================================================================================================================================================================         |  96%
  |                                                                                                                                                                                                                                                      
  |========================================================================================================================================================================================================================================        |  97%
  |                                                                                                                                                                                                                                                      
  |==========================================================================================================================================================================================================================================      |  98%
  |                                                                                                                                                                                                                                                      
  |============================================================================================================================================================================================================================================    |  98%
  |                                                                                                                                                                                                                                                      
  |==============================================================================================================================================================================================================================================  |  99%
  |                                                                                                                                                                                                                                                      
  |================================================================================================================================================================================================================================================| 100%</code></pre>
<pre class="r"><code>plot(mb)</code></pre>
<pre><code>## Model-based clustering plots: 
## 
## 1: BIC
## 2: classification
## 3: uncertainty
## 4: density</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" /><!-- --></p>
<pre><code>## Model-based clustering plots: 
## 
## 1: BIC
## 2: classification
## 3: uncertainty
## 4: density</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-20-2.png" /><!-- --></p>
<pre><code>## Model-based clustering plots: 
## 
## 1: BIC
## 2: classification
## 3: uncertainty
## 4: density</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-20-3.png" /><!-- --></p>
<pre><code>## Model-based clustering plots: 
## 
## 1: BIC
## 2: classification
## 3: uncertainty
## 4: density</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-20-4.png" /><!-- --></p>
<pre><code>## Model-based clustering plots: 
## 
## 1: BIC
## 2: classification
## 3: uncertainty
## 4: density</code></pre>
<pre class="r"><code>summary(mb)</code></pre>
<pre><code>## ----------------------------------------------------
## Gaussian finite mixture model fitted by EM algorithm 
## ----------------------------------------------------
## 
## Mclust VII (spherical, varying volume) model with 5 components:
## 
##  log.likelihood  n df       BIC       ICL
##       -220.7207 60 29 -560.1775 -561.8828
## 
## Clustering table:
##  1  2  3  4  5 
## 11  8 17 17  7</code></pre>
<p><br></p>
</div>
<div id="dissimilarity-matrix" class="section level1">
<h1><span class="header-section-number">9</span> Dissimilarity matrix</h1>
<p><img src="images/12.PNG" width="729" /></p>
<pre class="r"><code>library(seriation)

dissplot(dist(customer), labels=km$cluster,
         options=list(main=&quot;Kmeans Clustering With k=4&quot;))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" /><!-- --></p>
<pre class="r"><code>complete_c = hclust(dist(customer), method=&quot;complete&quot;)
hc_complete = cutree(complete_c, k = 4)
dissplot(dist(customer), labels=hc_complete,
         options=list(main=&quot;Hierarchical Clustering&quot;))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-22-2.png" /><!-- --></p>
<pre class="r"><code>image(as.matrix(dist(customer)))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-22-3.png" /><!-- --></p>
<pre class="r"><code>cd=dist(customer)
hc=hclust(cd)
cdt=dist(t(customer))
hcc=hclust(cdt)
heatmap(customer, Rowv=as.dendrogram(hc), Colv=as.dendrogram(hcc))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-22-4.png" /><!-- --></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
